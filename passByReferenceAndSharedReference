/**
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 * PASS BY REFERENCE & SHARED REFERENCES - VISUAL DEMONSTRATION
 * 
 * In Kotlin/Java:
 * - Primitives are passed by VALUE (copy of the value)
 * - Objects are passed by REFERENCE (copy of the memory address)
 * 
 * This means multiple variables can point to the SAME object!
 * â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
 */

/**
 * Bank Account - Our main object to demonstrate references
 */
class BankAccount(
    val accountNumber: String,
    var owner: String,
    var balance: Double
) {
    fun deposit(amount: Double) {
        balance += amount
        println("ğŸ’µ Deposited $$amount â†’ New balance: $$balance")
    }
    
    fun withdraw(amount: Double): Boolean {
        if (balance >= amount) {
            balance -= amount
            println("ğŸ’¸ Withdrew $$amount â†’ New balance: $$balance")
            return true
        }
        println("âŒ Insufficient funds! Balance: $$balance")
        return false
    }
    
    override fun toString() = "Account($accountNumber): $owner - $${"%.2f".format(balance)}"
}

/**
 * Visual helper to show memory state
 */
fun showMemoryDiagram(title: String, varName1: String, varName2: String = "", showsSameObject: Boolean = false) {
    println("\nâ”Œâ”€â”€â”€ $title â”€â”€â”€")
    if (showsSameObject) {
        println("â”‚")
        println("â”‚  STACK                 HEAP")
        println("â”‚  â”€â”€â”€â”€â”€                 â”€â”€â”€â”€")
        println("â”‚  $varName1 â”€â”€â”€â”€â”€â”")
        println("â”‚                 â”œâ”€â”€â”€â†’  [BankAccount Object]")
        println("â”‚  $varName2 â”€â”€â”€â”€â”€â”˜       â€¢ accountNumber")
        println("â”‚                          â€¢ owner")
        println("â”‚                          â€¢ balance")
        println("â”‚")
        println("â”‚  âš ï¸ Both variables point to the SAME object!")
    } else {
        println("â”‚")
        println("â”‚  STACK                 HEAP")
        println("â”‚  â”€â”€â”€â”€â”€                 â”€â”€â”€â”€")
        println("â”‚  $varName1 â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’  [BankAccount Object]")
        println("â”‚                          â€¢ accountNumber")
        println("â”‚                          â€¢ owner")
        println("â”‚                          â€¢ balance")
    }
    println("â””" + "â”€".repeat(50))
}

/**
 * Function that modifies account (demonstrates pass by reference)
 */
fun processTransaction(account: BankAccount, amount: Double, type: String) {
    println("\nğŸ“ Inside processTransaction function:")
    println("   Received account: $account")
    
    when (type) {
        "deposit" -> account.deposit(amount)
        "withdraw" -> account.withdraw(amount)
    }
    
    // This modification affects the ORIGINAL object!
    println("   After transaction: $account")
}

/**
 * Function that tries to reassign parameter (won't affect original)
 */
fun tryToReassignAccount(account: BankAccount) {
    println("\nğŸ”„ Inside tryToReassignAccount function:")
    println("   Received: $account")
    
    // This creates a LOCAL reference, doesn't affect original!
    var localAccount = account
    localAccount = BankAccount("NEW123", "New Owner", 0.0)
    
    println("   Local reassigned to: $localAccount")
    println("   But parameter still points to: $account")
}

/**
 * Demonstrate primitives are passed by value
 */
fun modifyPrimitive(value: Int): Int {
    var localValue = value
    localValue += 100
    println("   Inside function: localValue = $localValue")
    return localValue
}

fun main() {
    println("â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
    println("â•‘     PASS BY REFERENCE & SHARED REFERENCES - VISUAL DEMO      â•‘")
    println("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // PART 1: PRIMITIVES - Pass by Value
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    println("\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    println("  PART 1: PRIMITIVES - Pass by Value (Copy)")
    println("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    
    var myNumber = 42
    println("\nğŸ“Š Original number: $myNumber")
    
    println("\nğŸ”¢ Passing primitive to function...")
    val result = modifyPrimitive(myNumber)
    
    println("\nâœ… After function call:")
    println("   Original myNumber: $myNumber")  // Unchanged!
    println("   Returned value: $result")
    
    println("\nğŸ’¡ Primitives are COPIED when passed to functions!")
    println("   The function works with a copy, not the original.")
    
    // Visual representation
    println("""
    
    â”Œâ”€â”€â”€ How Primitives are Passed â”€â”€â”€
    â”‚
    â”‚  myNumber = 42  â”€â”€â”
    â”‚                   â”‚ (copy value)
    â”‚                   â–¼
    â”‚  function(value = 42)  // Gets a COPY
    â”‚
    â”‚  Original unchanged! âœ…
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    """.trimIndent())
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // PART 2: OBJECTS - Pass by Reference
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    println("\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    println("  PART 2: OBJECTS - Pass by Reference (Address)")
    println("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    
    val aliceAccount = BankAccount("ACC001", "Alice", 1000.0)
    println("\nğŸ¦ Created account: $aliceAccount")
    
    showMemoryDiagram("Initial State", "aliceAccount")
    
    println("\nğŸ’° Calling processTransaction(deposit $500)...")
    processTransaction(aliceAccount, 500.0, "deposit")
    
    println("\nğŸ” Back in main - checking original:")
    println("   Alice's account: $aliceAccount")
    println("   âš ï¸ Balance CHANGED! Function modified the ORIGINAL object!")
    
    println("\nğŸ’¡ Objects are passed by REFERENCE!")
    println("   The function receives the memory address, not a copy.")
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // PART 3: SHARED REFERENCES - Multiple Variables, Same Object
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    println("\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    println("  PART 3: SHARED REFERENCES - Multiple Variables, One Object")
    println("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    
    val jointAccount = BankAccount("ACC002", "Bob & Carol", 2000.0)
    println("\nğŸ‘« Created joint account: $jointAccount")
    
    // Both variables point to the SAME account
    val bobsAccess = jointAccount
    val carolsAccess = jointAccount
    
    showMemoryDiagram("Shared References", "bobsAccess", "carolsAccess", true)
    
    // Check if they're the same object
    println("\nğŸ” Reference Check:")
    println("   bobsAccess === carolsAccess: ${bobsAccess === carolsAccess}")
    println("   bobsAccess === jointAccount: ${bobsAccess === jointAccount}")
    println("   âœ… All TRUE - same object in memory!")
    
    // Bob makes a withdrawal
    println("\nğŸ‘¨ Bob withdraws $300...")
    bobsAccess.withdraw(300.0)
    
    // Carol checks the balance
    println("\nğŸ‘© Carol checks her access:")
    println("   Carol sees: $carolsAccess")
    println("   âš ï¸ Bob's withdrawal affected Carol's view!")
    
    // Original variable also shows the change
    println("\nğŸ¦ Original joint account: $jointAccount")
    println("   âš ï¸ ALL variables see the same changes!")
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // PART 4: ASSIGNMENT - Creates Reference, Not Copy!
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    println("\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    println("  PART 4: ASSIGNMENT - Creates Reference, Not Copy")
    println("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    
    val originalAccount = BankAccount("ACC003", "David", 3000.0)
    println("\nğŸ¦ Original account: $originalAccount")
    
    println("\nğŸ“‹ Attempting 'backup' with assignment:")
    val backup = originalAccount  // This is NOT a backup!
    println("   backup = originalAccount")
    
    println("\nğŸ” Are they the same object?")
    println("   backup === originalAccount: ${backup === originalAccount}")
    println("   âš ï¸ TRUE - 'backup' is just another reference!")
    
    println("\nğŸ’¸ Original account withdraws $1000...")
    originalAccount.withdraw(1000.0)
    
    println("\nğŸ˜± Checking 'backup':")
    println("   Backup account: $backup")
    println("   âŒ The 'backup' also shows the withdrawal!")
    
    println("""
    
    â”Œâ”€â”€â”€ Why Assignment Doesn't Create Copies â”€â”€â”€
    â”‚
    â”‚  originalAccount â”€â”€â”€â”€â”
    â”‚                      â”œâ”€â”€â†’ [BankAccount@1234]
    â”‚  backup = original â”€â”€â”˜     balance: 2000.0
    â”‚
    â”‚  Both point to SAME object!
    â”‚  This is NOT a backup! âŒ
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    """.trimIndent())
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // PART 5: COLLECTIONS - Also Passed by Reference
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    println("\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    println("  PART 5: COLLECTIONS - Also Objects, Also Referenced")
    println("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    
    val accountsList = mutableListOf(
        BankAccount("ACC004", "Eve", 4000.0),
        BankAccount("ACC005", "Frank", 5000.0)
    )
    
    println("\nğŸ“‹ Created list of accounts:")
    accountsList.forEach { println("   - $it") }
    
    // Function that modifies the list
    fun addVIPAccount(accounts: MutableList<BankAccount>) {
        println("\nğŸŒŸ Inside addVIPAccount function:")
        accounts.add(BankAccount("VIP001", "Grace (VIP)", 10000.0))
        println("   Added VIP account to list")
    }
    
    println("\nğŸ“ Calling addVIPAccount...")
    addVIPAccount(accountsList)
    
    println("\nğŸ” Back in main - checking original list:")
    println("   List size: ${accountsList.size}")
    accountsList.forEach { println("   - $it") }
    println("   âš ï¸ Original list was modified!")
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // PART 6: REASSIGNMENT - Doesn't Affect Original Reference
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    println("\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    println("  PART 6: REASSIGNMENT - Local Only")
    println("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    
    val henryAccount = BankAccount("ACC006", "Henry", 6000.0)
    println("\nğŸ¦ Henry's account: $henryAccount")
    
    tryToReassignAccount(henryAccount)
    
    println("\nğŸ” Back in main - checking Henry's account:")
    println("   Henry's account: $henryAccount")
    println("   âœ… Unchanged! Reassignment in function was local only.")
    
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // SUMMARY
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    println("\nâ•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—")
    println("â•‘                        KEY TAKEAWAYS                          â•‘")
    println("â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£")
    println("â•‘                                                                â•‘")
    println("â•‘  PRIMITIVES (Int, Double, Boolean, etc.):                     â•‘")
    println("â•‘  â€¢ Passed by VALUE (copy)                                     â•‘")
    println("â•‘  â€¢ Function gets a copy                                       â•‘")
    println("â•‘  â€¢ Original unchanged                                         â•‘")
    println("â•‘                                                                â•‘")
    println("â•‘  OBJECTS (including Collections):                             â•‘")
    println("â•‘  â€¢ Passed by REFERENCE (memory address)                       â•‘")
    println("â•‘  â€¢ Function gets address to same object                       â•‘")
    println("â•‘  â€¢ Modifications affect original                              â•‘")
    println("â•‘                                                                â•‘")
    println("â•‘  ASSIGNMENT (=):                                              â•‘")
    println("â•‘  â€¢ For objects: Copies the REFERENCE, not the object          â•‘")
    println("â•‘  â€¢ Multiple variables can point to same object                â•‘")
    println("â•‘  â€¢ Changes through any reference affect all                   â•‘")
    println("â•‘                                                                â•‘")
    println("â•‘  REFERENCE EQUALITY (===):                                    â•‘")
    println("â•‘  â€¢ Checks if two variables point to SAME object               â•‘")
    println("â•‘  â€¢ true = same object in memory                               â•‘")
    println("â•‘  â€¢ false = different objects (even if equal content)          â•‘")
    println("â•‘                                                                â•‘")
    println("â•‘  REMEMBER:                                                    â•‘")
    println("â•‘  When you pass an object to a function or assign it to        â•‘")
    println("â•‘  another variable, you're sharing the SAME object!            â•‘")
    println("â•‘                                                                â•‘")
    println("â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
    
    // Final visual
    println("""
    
    â”Œâ”€â”€â”€ The Golden Rule â”€â”€â”€
    â”‚
    â”‚  Primitives: COPIED ğŸ“‹
    â”‚  Objects: REFERENCED ğŸ‘‰
    â”‚
    â”‚  val x = 5
    â”‚  val y = x         // y gets COPY of 5
    â”‚
    â”‚  val acc1 = BankAccount(...)
    â”‚  val acc2 = acc1   // acc2 points to SAME account
    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    """.trimIndent())
}
